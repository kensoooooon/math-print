<html><!--django??function_call??????-->
<head>
  <meta charset="utf-8" />
  <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
  <script>
    window.addEventListener("load", draw2);

    function drawLine(stage, start_x, start_y, end_x, end_y) {
        var graphic = new createjs.Graphics();
        graphic.beginStroke("#000000");
        graphic.moveTo(start_x, start_y);
        graphic.lineTo(end_x, end_y);
        graphic.endStroke();
        var shape = new createjs.Shape(graphic);
        stage.addChild(shape);

    }

    function drawLineWithAngle(stage, start_x, start_y, angle, radius=200) {
        // draw line detemined by angle
        var graphic = new createjs.Graphics();
        graphic.beginStroke("#000000");
        graphic.moveTo(start_x, start_y);
        var radian = angle * Math.PI / 180;
        var end_x = start_x + radius * Math.cos(radian);
        var end_y = start_y + radius * Math.sin(radian);
        graphic.lineTo(end_x, end_y);
        graphic.endStroke();
        var shape = new createjs.Shape(graphic);
        stage.addChild(shape);
    }

    function drawArc(stage, center_x, center_y, radius, start_angle, end_angle, anticlockwise=false) {
        var graphic = new createjs.Graphics();
        graphic.beginStroke("#000000");
        var start_radian = start_angle * Math.PI / 180;
        var end_radian = end_angle * Math.PI / 180;
        graphic.arc(center_x, center_y, radius, start_radian, end_radian, anticlockwise);
        var shape = new createjs.Shape(graphic);
        stage.addChild(shape);
    }
    
    function drawDegreeCharacter(stage, x, y, character) {
      //文字オブジェクトを作成する
      var text = new createjs.Text(character, "20px Arial", "#000000");
      //描画位置の指定
      text.x = x;
      text.y = y;
      stage.addChild(text);
    }

    function random_vertical_angle_draw (stage, answer_angle) {
      // var stage = new createjs.Stage("myCanvas");
      // var answer_angle = Math.floor(Math.random() * (80 + 1 - 20)) + 20;
      console.log("answer_angle: "+answer_angle);
      var random_angle = Math.floor(Math.random() * (80 + 1 - 20)) + 20;
      console.log("random_angle: "+random_angle);
      var remained_angle = 180 - (answer_angle + random_angle);
      console.log("remained_angle: "+remained_angle);
      drawLine(stage, 30, 160, 610, 160);
      drawLineWithAngle(stage, 320, 160, -1*random_angle);
      drawLineWithAngle(stage, 320, 160, -1*random_angle+180);
      drawArc(stage, 320, 160, 50, 0, -1*random_angle, anticlockwise=true);
      drawDegreeCharacter(stage, 320+100, 160-40, random_angle+"°");
      drawLineWithAngle(stage, 320, 160, -1*random_angle-remained_angle);
      drawLineWithAngle(stage, 320, 160, -1*random_angle-remained_angle+180);
      drawArc(stage, 320, 160, 50, -1*random_angle+180, -1*random_angle-remained_angle+180, anticlockwise=true);
      drawDegreeCharacter(stage, 320-10, 160+120, remained_angle+"°");
      drawArc(stage, 320, 160, 50, -1*random_angle-remained_angle, 180, anticlockwise=true);
      drawDegreeCharacter(stage, 320-100, 160-40, "x");
      stage.update();
    }

    function random_parallel_angle_draw (stage, answer_angle) {
      // var stage = new createjs.Stage("sample_canvas");
      var docking_x = 150;
      var docking_y = 160;
      drawLine(stage, 10, 310, 630, 310);
      drawLine(stage, 10, 10, 630, 10);
      // drawLine(stage, 10, 160, 630, 160);
      // var a = Math.floor( Math.random() * (max + 1 - min) ) + min ;
      var random_angle = Math.floor(Math.random() * ((answer_angle - 20) + 1 - 20) + 20)
      // var angle1 = 120;
      var angle1 = random_angle;
      var radian1 = angle1 * Math.PI / 180;
      var radius1 = 150 / Math.sin(radian1);
      console.log("radius1: " + radius1)
      // drawLineWithAngle(stage, 320, 160, angle1, radius=radius1);
      drawLineWithAngle(stage, docking_x, docking_y, angle1, radius=radius1);
      // drawArc(stage, 320, 160, 50, 0, angle1);
      drawArc(stage, docking_x, docking_y, 50, 0, angle1);
      // the phase to calculate end line point.
      // var end_x1 = 320 + radius1 * Math.cos(radian1);
      var end_x1 = docking_x + radius1 * Math.cos(radian1);
      // var end_y1 = 160 + radius1 * Math.sin(radian1);
      var end_y1 = docking_y + radius1 * Math.sin(radian1);
      drawArc(stage, end_x1, end_y1, 50, 180, 180+angle1);
      console.log("angle1: " + angle1);
      drawDegreeCharacter(stage, end_x1-100, end_y1-30, angle1+"°");
      //
      // var angle2 = 100;
      var angle2 = answer_angle - random_angle;
      var radian2 = angle2 * Math.PI / 180;
      var radius2 = 150 / Math.sin(radian2);
      console.log("radius2: " + radius2)
      // drawLineWithAngle(stage, 320, 160, -angle2, radius=radius2);
      drawLineWithAngle(stage, docking_x, docking_y, -angle2, radius=radius2)
      // drawArc(stage, 320, 160, 50, 0, -angle2, anticlockwise=true);
      drawArc(stage, docking_x, docking_y, 50, 0, -angle2, anticlockwise=true);
      // the phase to calculate end line point.
      // var end_x2 = 320 + radius2 * Math.cos(-radian2);
      var end_x2 = docking_x + radius2 * Math.cos(-radian2);
      console.log("end_x2: " + end_x2);
      // var end_y2 = 160 + radius2 * Math.sin(-radian2);
      var end_y2 = docking_y + radius2 * Math.sin(-radian2);
      console.log("end_y2: " + end_y2);
      console.log("angle2: " + angle2);
      drawArc(stage, end_x2, end_y2, 50, 180-angle2, 180);
      // drawDegreeCharacter(stage, end_x2-90, end_y2+10, angle2+"°");
      drawDegreeCharacter(stage, end_x2-100, end_y2+10, angle2+"°");
      drawDegreeCharacter(stage, docking_x+60, docking_y-20, "x°");
      stage.update();
    }

    function sample_draw () {
      var stage = new createjs.Stage("sample_canvas");
      random_parallel_angle_draw(stage, 150);
    }

    function draw() {
      {% for answer_angle in answer_angle_list %}
      var canvas = document.createElement('canvas');
      var canvas_id = "canvas" + {{ forloop.counter }};
      canvas.id = canvas_id;
      console.log(canvas.id);
      canvas.width = 640;
      canvas.height = 320;
      canvas.style = "background-color:#CCFFFF";
      document.body.appendChild(canvas);
      var stage = new createjs.Stage(canvas_id);
      random_vertical_angle_draw(stage, {{ answer_angle }});
      {% endfor %}
    }

    function draw2() {
      {% for answer_angle in answer_angle_list %}
      var canvas = document.createElement('canvas');
      var canvas_id = "canvas" + {{ forloop.counter }};
      canvas.id = canvas_id;
      console.log(canvas.id);
      canvas.width = 640;
      canvas.height = 320;
      canvas.style = "background-color:#CCFFFF";
      document.body.appendChild(canvas);
      var stage = new createjs.Stage(canvas_id);
      random_parallel_angle_draw(stage, {{ answer_angle }});
      {% endfor %}
    }
  </script>
</head>
<body>
  <canvas id="sample_canvas" width="640" height="320" style="background-color:#CCFFFF;"></canvas>
</body>
</html>